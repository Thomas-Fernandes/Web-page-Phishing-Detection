effectifs <- table(restaurant$nb.convives)
barplot(effectifs,
main = "Distribution du nombre de convives",
xlab = "Nombre de convives",
ylab = "Effectifs",
space = 20)
box()
restaurant <- data.frame(
nb.convives = c(1, 1, 1, 2, 2, 2, 2, 2, 3, 3, 3, 4, 4, 6)
)
population <- nrow(restaurant)
effectif.total <- sum(restaurant$nb.convives)
#La variable étudiée est le nombre de convives elle est de type quantitative discrète
mode <- max(restaurant$nb.convives)
mediane <- median(restaurant$nb.convives)
moyenne <- mean(restaurant$nb.convives)
restaurant$nb.convives <- factor(restaurant$nb.convives, levels = 1:6)
effectifs <- table(restaurant$nb.convives)
barplot(effectifs,
main = "Distribution du nombre de convives",
xlab = "Nombre de convives",
ylab = "Effectifs",
ylim = c(0, 6),
space = 20)
box()
library(readr)
tabac <- read_csv("tabac.csv", show_col_types = FALSE)
head(tabac)
str(tabac)
summary(tabac)
View(tabac)
View(tabac)
View(tabac)
View(tabac)
View(tabac)
library(readr)
tabac <- read_csv("tabac.csv", show_col_types = FALSE)
head(tabac)
str(tabac)
summary(tabac)
#Ajout d'une variable fumeur de type binaire
tabac$fumeur <- ifelse(tabac$tabac == "oui", 1, 0)
library(readr)
tabac <- read_csv("tabac.csv", show_col_types = FALSE)
head(tabac)
str(tabac)
summary(tabac)
#Ajout d'une variable fumeur de type binaire
tabac$fumeur <- ifelse(tabac$tabagisme_passif == TRUE, 1, 0)
View(tabac)
library(readr)
tabac <- read_csv("tabac.csv", show_col_types = FALSE)
head(tabac)
str(tabac)
summary(tabac)
tabac$fumeur <- ifelse(tabac$tabagisme_passif == TRUE, 1, 0)
#Calculer les fréquences observées pour les modalités des variables "fumeur" et "problème pulmonaire"
freq.fumeur <- table(tabac$fumeur)
freq.pulmonaire <- table(tabac$problème_pulmonaire)
freq.fumeur
freq.pulmonaire
library(readr)
tabac <- read_csv("tabac.csv", show_col_types = FALSE)
head(tabac)
str(tabac)
summary(tabac)
tabac$fumeur <- ifelse(tabac$tabagisme_passif == TRUE, 1, 0)
#Calculer les fréquences observées pour les modalités des variables "fumeur" et "problème pulmonaire"
freq.fumeur <- table(tabac$fumeur)
freq.pulmonaire <- table(tabac$probleme_pulmonaire)
freq.pulmonaire <- table(tabac$probleme_pulmonaire)
freq.pulmonaire
library(readr)
tabac <- read_csv("tabac.csv", show_col_types = FALSE)
head(tabac)
str(tabac)
summary(tabac)
tabac$fumeur <- ifelse(tabac$tabagisme_passif == TRUE, 1, 0)
#Calculer les fréquences observées pour les modalités des variables "fumeur" et "problème pulmonaire"
freq.fumeur <- table(tabac$fumeur)
freq.pulmonaire <- table(tabac$probleme_pulmonaire)
#représenter les distributions de proportions de ces variables
barplot(freq.fumeur,
main = "Distribution du tabagisme passif",
xlab = "Tabagisme passif",
ylab = "Effectifs",
ylim = c(0, 6),
space = 20)
library(readr)
tabac <- read_csv("tabac.csv", show_col_types = FALSE)
head(tabac)
str(tabac)
summary(tabac)
tabac$fumeur <- ifelse(tabac$tabagisme_passif == TRUE, 1, 0)
#Calculer les fréquences observées pour les modalités des variables "fumeur" et "problème pulmonaire"
freq.fumeur <- table(tabac$fumeur)
freq.pulmonaire <- table(tabac$probleme_pulmonaire)
#représenter les distributions de proportions de ces variables
prop <- prop.table(freq.fumeur)
library(readr)
tabac <- read_csv("tabac.csv", show_col_types = FALSE)
head(tabac)
str(tabac)
summary(tabac)
tabac$fumeur <- ifelse(tabac$tabagisme_passif == TRUE, 1, 0)
#Calculer les fréquences observées pour les modalités des variables "fumeur" et "problème pulmonaire"
freq.fumeur <- table(tabac$fumeur)
freq.pulmonaire <- table(tabac$probleme_pulmonaire)
#représenter les distributions de proportions de ces variables
prop <- prop.table(freq.fumeur)
prop
View(tabac)
knitr::opts_chunk$set(echo = TRUE)
library(readr)
attach(tabac)
knitr::opts_chunk$set(echo = TRUE)
library(readr)
rm(list=ls())
tabac <- read.csv("D:/Documents/Drive/Ecole/M1/S1/Analyse de données/Analyse univariée/tabac.csv", header = TRUE, sep = ",")
attach(tabac)
head(tabac)
str(tabac)
dim(tabac)
summary(tabac)
tabac$fumeur <- tabac$tabac > 0
# Fréquences
#Fréquences de fumeurs (TRUE = nombre de fumeurs, FALSE = nombre de non fumeurs):")
table(tabac$fumeur)
#Fréquences de problèmes pulmonaires (TRUE = nombre de personnes avec problèmes pulmonaires, FALSE = nombre de personnes sans problèmes pulmonaires):
table(tabac$probleme_pulmonaire)
# Proportions
#Proportions de fumeurs (TRUE = proportion de fumeurs, FALSE = proportion de non fumeurs):
table(tabac$fumeur)/nrow(tabac)
# Proportions de problèmes pulmonaires (TRUE = proportion de personnes avec problèmes pulmonaires, FALSE = proportion de personnes sans problèmes pulmonaires):
table(tabac$probleme_pulmonaire)/nrow(tabac)
# Barplot des proportions
proportions <- matrix(c(1 - sum(tabac$fumeur) / nrow(tabac), sum(tabac$fumeur) / nrow(tabac),
1 - sum(tabac$probleme_pulmonaire) / nrow(tabac), sum(tabac$probleme_pulmonaire) / nrow(tabac)),
nrow = 2, ncol = 2)
# Barplot avec toutes les barres sur le même graphique
barplot(as.vector(proportions),
main = "Proportions de : fumeurs, personnes avec problèmes pulmonaires",
xlab = "Catégories",
ylab = "Proportion",
ylim = c(0, 1),
space = 5,
width = c(0.01, 0.01, 0.01, 0.01),
col = c("#6262e3", "#6262e3", "#50977d", "#50977d"),
names.arg = c("Non fumeur", "Fumeur", "Sans pb pul.", "Avec pb pul."),
cex.names = 0.8)
# Ajouter des légendes pour indiquer les groupes de barres
legend("topright", legend = c("Fumeur", "Problème pulmonaire"), fill = c("#6262e3", "#50977d"))
attach(tabac)
paste("Il y a", sum((tabac$fumeur)/nrow(tabac))*100, "% de fumeurs")
prop.test(table(fumeur), conf.level=0.95)
prop.test(sum(tabac$fumeur), nrow(tabac), conf.level=0.95)
# H0 : p = 0.5
# H1 : p < 0.5
# alpha = 0.05
# Test bilatéral de proportion
prop.test(sum(tabac$fumeur), nrow(tabac), p = 0.5, alternative = "less", conf.level=0.95)
attach(tabac)
(table_contingence <- table(tabac$fumeur, tabac$probleme_pulmonaire))
barplot(table_contingence, main="Distribution Jointe de Fumeurs et Problèmes Pulmonaires",
xlab="Fumeur", ylab="Problème Pulmonaire", legend=TRUE)
# Distribution jointe de fumeur et problème pulmonaire
table(tabac$fumeur, tabac$probleme_pulmonaire) / nrow(tabac)
# Distribution conditionnelle de fumeur sachant problème pulmonaire
(table_co)
# Distribution conditionnelle de fumeur sachant problème pulmonaire
(distrib_conditionnelle_1 <- table_contingence /colSums(table_contingence))
x <- c(10, 20)
y <- c(30, 40)
table(x, y)
# Distribution conditionnelle de fumeur sachant problème pulmonaire
(distrib_conditionnelle_1 <- table_contingence / rowSums(table_contingence))
conditional_fumeur <- prop.table(table_contingence, margin=1)
conditional_fumeur
-table_contingence
# Distribution conditionnelle de problème pulmonaire sachant fumeur
(distrib_conditionnelle_2 <- t(table_contingence) / colSums(t(table_contingence)))
# Distribution conditionnelle de problème pulmonaire sachant fumeur
(distrib_conditionnelle_2 <- table_contingence / colSums(t(table_contingence)))
# Distribution conditionnelle de fumeur sachant problème pulmonaire
(distrib_conditionnelle_1 <- table_contingence / rowSums(table_contingence))
# Distribution conditionnelle de problème pulmonaire sachant fumeur
(distrib_conditionnelle_2 <- table_contingence / colSums(t(table_contingence)))
# Distribution conditionnelle de problème pulmonaire sachant fumeur
(distrib_conditionnelle_2 <- table_contingence / colSums(table_contingence))
# Distribution conditionnelle de problème pulmonaire sachant fumeur
(distrib_conditionnelle_2 <- t(table_contingence) / colSums(table_contingence))
# Distribution conditionnelle de problème pulmonaire sachant fumeur
(distrib_conditionnelle_2 <- t(table_contingence) / colSums(table_contingence))
# Distribution conditionnelle de problème pulmonaire sachant fumeur
t((distrib_conditionnelle_2 <- t(table_contingence) / colSums(table_contingence)))
# Distribution conditionnelle de fumeur sachant problème pulmonaire
(distrib_conditionnelle_1 <- table_contingence / rowSums(table_contingence))
# Distribution conditionnelle de problème pulmonaire sachant fumeur
t((distrib_conditionnelle_2 <- t(table_contingence) / colSums(table_contingence)))
#plot
plot(factor(probleme_pulmonaire), factor(fumeur), xlab="probleme pulmonaire",ylab="fumeur")
rm(list=ls())
tabac <- read.csv("D:/Documents/Drive/Ecole/M1/S1/Analyse de données/Analyse univariée/tabac.csv", header = TRUE, sep = ",")
attach(tabac)
head(tabac)
str(tabac)
dim(tabac)
summary(tabac)
tabac$fumeur <- tabac$tabac > 0
# Fréquences
#Fréquences de fumeurs (TRUE = nombre de fumeurs, FALSE = nombre de non fumeurs):")
table(tabac$fumeur)
#Fréquences de problèmes pulmonaires (TRUE = nombre de personnes avec problèmes pulmonaires, FALSE = nombre de personnes sans problèmes pulmonaires):
table(tabac$probleme_pulmonaire)
# Proportions
#Proportions de fumeurs (TRUE = proportion de fumeurs, FALSE = proportion de non fumeurs):
table(tabac$fumeur)/nrow(tabac)
# Proportions de problèmes pulmonaires (TRUE = proportion de personnes avec problèmes pulmonaires, FALSE = proportion de personnes sans problèmes pulmonaires):
table(tabac$probleme_pulmonaire)/nrow(tabac)
# Barplot des proportions
proportions <- matrix(c(1 - sum(tabac$fumeur) / nrow(tabac), sum(tabac$fumeur) / nrow(tabac),
1 - sum(tabac$probleme_pulmonaire) / nrow(tabac), sum(tabac$probleme_pulmonaire) / nrow(tabac)),
nrow = 2, ncol = 2)
# Barplot avec toutes les barres sur le même graphique
barplot(as.vector(proportions),
main = "Proportions de : fumeurs, personnes avec problèmes pulmonaires",
xlab = "Catégories",
ylab = "Proportion",
ylim = c(0, 1),
space = 5,
width = c(0.01, 0.01, 0.01, 0.01),
col = c("#6262e3", "#6262e3", "#50977d", "#50977d"),
names.arg = c("Non fumeur", "Fumeur", "Sans pb pul.", "Avec pb pul."),
cex.names = 0.8)
# Ajouter des légendes pour indiquer les groupes de barres
legend("topright", legend = c("Fumeur", "Problème pulmonaire"), fill = c("#6262e3", "#50977d"))
attach(tabac)
(table_contingence <- table(tabac$fumeur, tabac$probleme_pulmonaire))
barplot(table_contingence, main="Distribution Jointe de Fumeurs et Problèmes Pulmonaires",
xlab="Fumeur", ylab="Problème Pulmonaire", legend=TRUE)
# Distribution jointe de fumeur et problème pulmonaire
table(tabac$fumeur, tabac$probleme_pulmonaire) / nrow(tabac)
# Distribution conditionnelle de fumeur sachant problème pulmonaire
(distrib_conditionnelle_1 <- table_contingence / rowSums(table_contingence))
# Distribution conditionnelle de problème pulmonaire sachant fumeur
t((distrib_conditionnelle_2 <- t(table_contingence) / colSums(table_contingence)))
#plot
plot(factor(probleme_pulmonaire), factor(fumeur), xlab="probleme pulmonaire",ylab="fumeur")
attach(tabac)
(table_contingence <- table(tabac$fumeur, tabac$probleme_pulmonaire))
barplot(table_contingence, main="Distribution Jointe de Fumeurs et Problèmes Pulmonaires",
xlab="Fumeur", ylab="Problème Pulmonaire", legend=TRUE)
# Distribution jointe de fumeur et problème pulmonaire
table(tabac$fumeur, tabac$probleme_pulmonaire) / nrow(tabac)
# Distribution conditionnelle de fumeur sachant problème pulmonaire
(distrib_conditionnelle_1 <- table_contingence / rowSums(table_contingence))
# Distribution conditionnelle de problème pulmonaire sachant fumeur
t((distrib_conditionnelle_2 <- t(table_contingence) / colSums(table_contingence)))
#plot
plot(factor(probleme_pulmonaire), factor(fumeur), xlab="probleme pulmonaire",ylab="fumeur")
attach(tabac)
(table_contingence <- table(tabac$fumeur, tabac$probleme_pulmonaire))
barplot(table_contingence, main="Distribution Jointe de Fumeurs et Problèmes Pulmonaires",
xlab="Fumeur", ylab="Problème Pulmonaire", legend=TRUE)
# Distribution jointe de fumeur et problème pulmonaire
table(tabac$fumeur, tabac$probleme_pulmonaire) / nrow(tabac)
# Distribution conditionnelle de fumeur sachant problème pulmonaire
(distrib_conditionnelle_1 <- table_contingence / rowSums(table_contingence))
# Distribution conditionnelle de problème pulmonaire sachant fumeur
t((distrib_conditionnelle_2 <- t(table_contingence) / colSums(table_contingence)))
#plot
plot(factor(probleme_pulmonaire), factor(fumeur), xlab="probleme pulmonaire",ylab="fumeur")
plot(factor(fumeur), factor(probleme_pulmonaire), xlab="fumeur",ylab="probleme pulmonaire")
# Analogue
plot(factor(probleme_pulmonaire), factor(fumeur), xlab="probleme pulmonaire",ylab="fumeur")
plot(factor(fumeur), factor(probleme_pulmonaire), xlab="fumeur",ylab="probleme pulmonaire")
# Distribution conditionnelle de fumeur sachant problème pulmonaire
barplot(table(tabac$fumeur, tabac$probleme_pulmonaire) / sum(tabac$probleme_pulmonaire),
main = "Distribution conditionnelle de fumeur sachant problème pulmonaire",
xlab = "Fumeur",
ylab = "Proportion",
ylim = c(0, 2),
space = 5,
width = c(0.01, 0.01),
col = c("#6262e3", "#50977d"),
names.arg = c("Non fumeur", "Fumeur"),
cex.names = 0.8)
# Distribution conditionnelle de problème pulmonaire sachant fumeur
barplot(table(tabac$fumeur, tabac$probleme_pulmonaire) / sum(tabac$fumeur),
main = "Distribution conditionnelle de problème pulmonaire sachant fumeur",
xlab = "Problème pulmonaire",
ylab = "Proportion",
ylim = c(0, 2),
space = 5,
width = c(0.01, 0.01),
col = c("#6262e3", "#50977d"),
names.arg = c("Sans pb pul.", "Avec pb pul."),
cex.names = 0.8)
# Distribution conditionnelle de fumeur sachant problème pulmonaire
(distrib_conditionnelle_1 <- table_contingence / rowSums(table_contingence))
# Distribution conditionnelle de problème pulmonaire sachant fumeur
t((distrib_conditionnelle_2 <- t(table_contingence) / colSums(table_contingence)))
plot(x = factor(fumeur), y = factor(probleme_pulmonaire), xlab="fumeur",ylab="probleme pulmonaire")
View(tabac)
t((distrib_conditionnelle_2 <- table_contingence/ colSums(table_contingence)))
setwd("C:/Users/thoma/Desktop/Github/Web-page-Phishing-Detection")
if (requireNamespace("thematic"))
thematic::thematic_rmd(font = "auto")
library(readr)
df <- read_csv("dataset_phishing.csv")
library(readr)
df <- read_csv("dataset_phishing.csv", show_col_types = FALSE)
View(df)
glimpse(df)
library(readr)
library(dplyr)
library(ggplot2)
df <- read_csv("dataset_phishing.csv", show_col_types = FALSE)
glimpse(df)
library(readr)
library(dplyr)
library(ggplot2)
df <- read_csv("dataset_phishing.csv", show_col_types = FALSE)
head(df)
df$status <- as.factor(df$status)
ggplot(df, aes(x=status, fill=status)) +
geom_bar() +
labs(x="Classe", y="Nombre d'Observations", fill="Statut") +
ggtitle("Distribution des Classes de Phishing vs Légitimes") +
theme_minimal()
df$status <- as.factor(df$status)
ggplot(df, aes(x=status, fill=status)) +
geom_bar() +
labs(x="Classe", y="Nombre d'Observations", fill="Statut") +
ggtitle("Distribution des Classes de Phishing vs Légitimes")
# Histogramme pour 'length_url'
ggplot(df, aes(x=length_url)) +
geom_histogram(bins=30, fill="blue", alpha=0.7) +
labs(x="Longueur de l'URL", y="Fréquence") +
ggtitle("Distribution de la Longueur des URL") +
theme_minimal()
# Boîte à moustaches pour 'length_url'
ggplot(df, aes(y=length_url, x=status, fill=status)) +
geom_boxplot() +
labs(x="Statut", y="Longueur de l'URL", fill="Statut") +
ggtitle("Boîte à Moustaches de la Longueur des URL par Statut") +
theme_minimal()
# Histogramme pour 'nb_hyphens'
ggplot(df, aes(x=nb_hyphens)) +
geom_histogram(bins=30, fill="green", alpha=0.7) +
labs(x="Nombre de Tirets", y="Fréquence") +
ggtitle("Distribution du Nombre de Tirets dans les URL") +
theme_minimal()
# Histogramme pour 'ratio_digits_url'
ggplot(df, aes(x=ratio_digits_url)) +
geom_histogram(bins=30, fill="red", alpha=0.7) +
labs(x="Ratio de Chiffres dans l'URL", y="Fréquence") +
ggtitle("Distribution du Ratio de Chiffres dans les URL") +
theme_minimal()
install.packages("corrplot")
install.packages("ggcorrplot")
library(corrplot)
library(ggcorrplot)
library(readr)
library(dplyr)
library(ggplot2)
library(corrplot)
library(ggcorrplot)
df <- read_csv("dataset_phishing.csv", show_col_types = FALSE)
cor_matrix <- cor(df[, numeric_columns], use = "complete.obs")
numeric_columns <- sapply(df, is.numeric)
cor_matrix <- cor(df[, numeric_columns], use = "complete.obs")
numeric_columns <- sapply(df, is.numeric)
cor_matrix <- cor(df[, numeric_columns], use = "complete.obs")
corrplot(cor_matrix, method = "circle")
numeric_columns <- sapply(df, is.numeric)
cor_matrix <- cor(df[, numeric_columns], use = "complete.obs")
ggcorrplot(cor_matrix, hc.order = TRUE, outline.col = "white")
numeric_columns <- sapply(df, is.numeric)
cor_matrix <- cor(df[, numeric_columns], use = "complete.obs")
corrplot(cor_matrix, method = "circle")
numeric_columns <- sapply(df, is.numeric)
cor_matrix <- cor(df[, numeric_columns], use = "complete.obs")
corrplot(cor_matrix, method = "circle", tl.cex = 0.6, cl.cex = 0.6)
# Assurez-vous que la colonne URL est de type caractère
df$url <- as.character(df$url)
# Utilisation d'une expression régulière pour extraire les TLD des URL
df$tld <- sub('.*\\.', '', df$url)
# Calcul de la fréquence des TLD
tld_table <- table(df$tld)
# Création d'un dataframe à partir de la table des fréquences
tld_freq <- as.data.frame(tld_table)
# Nommer les colonnes du dataframe
names(tld_freq) <- c("TLD", "Frequency")
# Trier le dataframe par fréquence décroissante
tld_freq <- tld_freq[order(-tld_freq$Frequency),]
# Visualisation avec ggplot2
ggplot(tld_freq, aes(x=reorder(TLD, -Frequency), y=Frequency)) +
geom_bar(stat="identity", fill="steelblue") +
theme_minimal() +
labs(x="Top-Level Domain", y="Fréquence") +
ggtitle("Fréquence des TLD dans les URL") +
theme(axis.text.x = element_text(angle = 90, hjust = 1))  # Rotation des étiquettes de l'axe X pour améliorer la lisibilité
indxTrain <- createDataPartition(df$status, p = 0.7, list = FALSE)
library(readr)
library(dplyr)
library(ggplot2)
library(corrplot)
library(ggcorrplot)
library(caret)
df <- read_csv("dataset_phishing.csv", show_col_types = FALSE)
indxTrain <- createDataPartition(df$status, p = 0.7, list = FALSE)
DTrain <- df[indxTrain, ]
DTest <- df[-indxTrain, ]
cat("Nombre d'observations dans l'ensemble d'entraînement:", nrow(training_set), "\n")
indxTrain <- createDataPartition(df$status, p = 0.7, list = FALSE)
DTrain <- df[indxTrain, ]
DTest <- df[-indxTrain, ]
cat("Nombre d'observations dans l'ensemble d'entraînement:", nrow(DTrain), "\n")
cat("Nombre d'observations dans l'ensemble de test:", nrow(DTest), "\n")
indxTrain <- createDataPartition(df$status, p = 0.75, list = FALSE)
DTrain <- df[indxTrain, ]
DTest <- df[-indxTrain, ]
cat("Nombre d'observations dans l'ensemble d'entraînement:", nrow(DTrain), "\n")
cat("Nombre d'observations dans l'ensemble de test:", nrow(DTest), "\n")
install.packages("klaR")
indxTrain <- createDataPartition(df$status, p = 0.75, list = FALSE)
DTrain <- df[indxTrain, ]
DTest <- df[-indxTrain, ]
cat("Nombre d'observations dans l'ensemble d'entraînement:", nrow(DTrain), "\n")
cat("Nombre d'observations dans l'ensemble de test:", nrow(DTest), "\n")
#Nuage de points des données d'entraînement
plot(DTrain, col = thematic::thematic_get_option("accent"))
ctrl <- trainControl(method = "none")
ctrl <- trainControl(method = "none")
set.seed(123) # Pour la reproductibilité
fit.knn <- train(status ~ ., data = DTrain, method = "knn", tuneGrid = data.frame(k = 5), trControl = ctrl)
predictions <- predict(fit.knn, newdata = DTest)
gc()
if (requireNamespace("thematic"))
thematic::thematic_rmd(font = "auto")
library(readr)
library(dplyr)
library(ggplot2)
library(corrplot)
library(ggcorrplot)
library(caret)
df <- read_csv("dataset_phishing.csv", show_col_types = FALSE)
df <- df[,-1]
head(df)
df$status <- as.factor(df$status)
ggplot(df, aes(x=status, fill=status)) +
geom_bar() +
labs(x="Classe", y="Nombre d'Observations", fill="Statut") +
ggtitle("Distribution des Classes de Phishing vs Légitimes")
# Histogramme pour 'length_url'
ggplot(df, aes(x=length_url)) +
geom_histogram(bins=30, fill="blue", alpha=0.7) +
labs(x="Longueur de l'URL", y="Fréquence") +
ggtitle("Distribution de la Longueur des URL") +
theme_minimal()
# Boîte à moustaches pour 'length_url'
ggplot(df, aes(y=length_url, x=status, fill=status)) +
geom_boxplot() +
labs(x="Statut", y="Longueur de l'URL", fill="Statut") +
ggtitle("Boîte à Moustaches de la Longueur des URL par Statut") +
theme_minimal()
# Histogramme pour 'nb_hyphens'
ggplot(df, aes(x=nb_hyphens)) +
geom_histogram(bins=30, fill="green", alpha=0.7) +
labs(x="Nombre de Tirets", y="Fréquence") +
ggtitle("Distribution du Nombre de Tirets dans les URL") +
theme_minimal()
# Histogramme pour 'ratio_digits_url'
ggplot(df, aes(x=ratio_digits_url)) +
geom_histogram(bins=30, fill="red", alpha=0.7) +
labs(x="Ratio de Chiffres dans l'URL", y="Fréquence") +
ggtitle("Distribution du Ratio de Chiffres dans les URL") +
theme_minimal()
numeric_columns <- sapply(df, is.numeric)
cor_matrix <- cor(df[, numeric_columns], use = "complete.obs")
corrplot(cor_matrix, method = "circle", tl.cex = 0.6, cl.cex = 0.6)
indxTrain <- createDataPartition(df$status, p = 0.75, list = FALSE)
DTrain <- df[indxTrain, ]
DTest <- df[-indxTrain, ]
cat("Nombre d'observations dans l'ensemble d'entraînement:", nrow(DTrain), "\n")
cat("Nombre d'observations dans l'ensemble de test:", nrow(DTest), "\n")
ctrl <- trainControl(method = "none")
set.seed(123) # Pour la reproductibilité
fit.knn <- train(status ~ ., data = DTrain, method = "knn", tuneGrid = data.frame(k = 5), trControl = ctrl)
predictions <- predict(fit.knn, newdata = DTest)
predictions
# Matrice de confusion
confusionMatrix <- confusionMatrix(predictions, DTest$status)
print(confusionMatrix$table)
print(confusionMatrix$overall['Accuracy'])
errorRate <- 1 - confusionMatrix$overall['Accuracy']
print(errorRate)
# Recherche du meilleur k
ctrl <- trainControl(method = "cv", number = 10) # 10-fold cross-validation
# Entraînement du modèle avec une recherche de différents k
knnFit <- train(status ~ ., data = DTrain, method = "knn", trControl = ctrl, tuneLength = 20, preProcess = c("center", "scale"))
# Visualisation des résultats
plot(knnFit)
print(knnFit$results)
print(knnFit$bestTune)
# Estimation de l'erreur de prédiction avec le meilleur k sur les données de test
bestK <- knnFit$bestTune$k
predictionsBestK <- predict(knnFit, newdata = DTest)
confusionMatrixBestK <- confusionMatrix(predictionsBestK, DTest$status)
errorRateBestK <- 1 - confusionMatrixBestK$overall['Accuracy']
print(errorRateBestK)
